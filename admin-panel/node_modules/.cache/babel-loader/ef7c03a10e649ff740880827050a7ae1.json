{"ast":null,"code":"import _classCallCheck from\"/home/szymon/College/PUZ-Biblioteka/Admin-Panel/admin-panel/admin-panel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/szymon/College/PUZ-Biblioteka/Admin-Panel/admin-panel/admin-panel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/szymon/College/PUZ-Biblioteka/Admin-Panel/admin-panel/admin-panel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/szymon/College/PUZ-Biblioteka/Admin-Panel/admin-panel/admin-panel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import Moment from'moment';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Borrow=/*#__PURE__*/function(_Component){_inherits(Borrow,_Component);var _super=_createSuper(Borrow);function Borrow(){var _this;_classCallCheck(this,Borrow);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={borrow:[],username:\"\",notFound:false,errorMessage:\"\"};_this.fetchBorrow=function(page,limit,username){fetch(_this.props.prefix+\"/api/library/admins/rental?page=\".concat(page,\"&limit=\").concat(limit,\"&username=\").concat(username),{method:'GET',headers:{\"Content-Type\":\"application/json\",\"Authorization\":_this.props.getToken()}}).then(function(res){return res.json();}).then(function(res){if(res.status===404){_this.setState({notFound:true,errorMessage:res.message});}else if(res.status==403){_this.setState({notFound:true,errorMessage:\"You have to login to administrator account to get access to this resource\"});}else{_this.setState({borrow:res,notFound:false});}});};_this.confirmReturn=function(id){fetch(\"\".concat(_this.props.prefix,\"/api/library/admins/confirmReturn/\").concat(id),{method:'POST',headers:{\"Content-Type\":\"application/json\",\"Authorization\":_this.props.getToken()}}).then(function(res){if(res.status===200){alert(\"Book returned\");var filteredArray=_this.state.borrow.filter(function(e){return e.id!==id;});_this.setState({borrow:filteredArray});}});};_this.extend=function(id){// fetch(`${this.props.prefix}/api/library/admins/rental/extend/${id}`,  {\n//    method: 'POST',\n//    headers: {\n//     \"Content-Type\": \"application/json\",\n//     \"Authorization\": this.props.getToken()\n// }\n//   })\n//   .then(res => {\n//       if(res.status === 200){\n//           alert(\"Book extended\");\n//           \n//       }\n//   });\n};_this.usernameHandler=function(name){_this.setState({username:name.target.value});};_this.filterByUsername=function(e){e.preventDefault();_this.fetchBorrow(0,10,_this.state.username);};return _this;}_createClass(Borrow,[{key:\"componentDidMount\",value:function componentDidMount(){this.fetchBorrow(0,10,this.state.username);}},{key:\"render\",value:function render(){var _this2=this;var _this$state=this.state,borrow=_this$state.borrow,notFound=_this$state.notFound,errorMessage=_this$state.errorMessage;if(!borrow.length&&notFound===false){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}else if(notFound===true){return/*#__PURE__*/_jsxs(\"section\",{children:[this.searchBar(),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"b\",{children:errorMessage})})]});}return/*#__PURE__*/_jsxs(\"section\",{children:[this.searchBar(),this.state.borrow.map(function(borrow,index){return/*#__PURE__*/_jsx(\"div\",{className:\"card mb-3\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsxs(\"h5\",{className:\"card-title\",children:[\"#\",borrow.id,\". \",borrow.title]}),/*#__PURE__*/_jsx(\"h6\",{className:\"card-subtitle mb-2 text-muted\",children:Moment(borrow.dateIssued).format('YYYY-MM-DD')}),/*#__PURE__*/_jsx(\"p\",{className:\"card-text\",children:borrow.username}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-success\",onClick:function onClick(){return _this2.confirmReturn(borrow.id);},children:\"Confirm\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-warning ms-2\",onClick:function onClick(){return _this2.extend(borrow.id);},children:\"Extend\"})]})},index);})]});}},{key:\"searchBar\",value:function searchBar(){return/*#__PURE__*/_jsxs(\"form\",{className:\"d-flex justify-content-center mb-5\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-auto\",children:/*#__PURE__*/_jsx(\"p\",{className:\"center-text mx-5\",children:\"Find by username\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-auto\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"visually-hidden\",children:\"Username\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",placeholder:\"username\",value:this.state.username,onChange:this.usernameHandler})]}),/*#__PURE__*/_jsx(\"div\",{className:\"col-auto\",children:/*#__PURE__*/_jsx(\"button\",{type:\"submit\",onClick:this.filterByUsername,className:\"btn btn-primary mb-3 mx-3\",children:\"Filter\"})})]});}}]);return Borrow;}(Component);export default Borrow;","map":{"version":3,"sources":["/home/szymon/College/PUZ-Biblioteka/Admin-Panel/admin-panel/admin-panel/src/components/borrow/Borrow.jsx"],"names":["React","Component","Moment","Borrow","state","borrow","username","notFound","errorMessage","fetchBorrow","page","limit","fetch","props","prefix","method","headers","getToken","then","res","json","status","setState","message","confirmReturn","id","alert","filteredArray","filter","e","extend","usernameHandler","name","target","value","filterByUsername","preventDefault","length","searchBar","map","index","title","dateIssued","format"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport Moment from 'moment';\n\nclass Borrow extends Component {\n    state = {\n        borrow: [],\n        username: \"\",\n        notFound: false,\n        errorMessage: \"\",\n     }\n\n    componentDidMount(){\n        this.fetchBorrow(0, 10, this.state.username);\n    }\n     \n\n    fetchBorrow = (page, limit, username) =>{\n    fetch(this.props.prefix + `/api/library/admins/rental?page=${page}&limit=${limit}&username=${username}`, {\n       method: 'GET',\n       headers: {\"Content-Type\": \"application/json\", \"Authorization\": this.props.getToken()}\n      })\n    .then(res => res.json())\n    .then(res => {\n        if(res.status === 404){\n            this.setState({notFound: true, errorMessage: res.message});\n        }\n        else if (res.status == 403){\n            this.setState({notFound: true, errorMessage: \"You have to login to administrator account to get access to this resource\"})\n        }\n        else{\n            this.setState({borrow: res, notFound: false})\n        }       \n    })\n  }\n\n\n  confirmReturn = (id) => {\n    fetch(`${this.props.prefix}/api/library/admins/confirmReturn/${id}`,  {\n       method: 'POST',\n       headers: {\n        \"Content-Type\": \"application/json\",\n        \"Authorization\": this.props.getToken()\n    }\n      })\n      .then(res => {\n          if(res.status === 200){\n              alert(\"Book returned\");\n              let filteredArray = this.state.borrow.filter(e => e.id !== id);\n              this.setState({borrow: filteredArray});\n          }\n      });\n  }\n\n  extend = (id) => {\n    // fetch(`${this.props.prefix}/api/library/admins/rental/extend/${id}`,  {\n    //    method: 'POST',\n    //    headers: {\n    //     \"Content-Type\": \"application/json\",\n    //     \"Authorization\": this.props.getToken()\n    // }\n    //   })\n    //   .then(res => {\n    //       if(res.status === 200){\n    //           alert(\"Book extended\");\n    //           \n    //       }\n    //   });\n  }\n\n  usernameHandler = (name) =>{\n    this.setState({username: name.target.value});\n}   \n\n  filterByUsername = (e) =>{\n    e.preventDefault();\n    this.fetchBorrow(0, 10, this.state.username);\n  }\n\n    render() { \n        const {borrow, notFound, errorMessage} = this.state;\n        if(!borrow.length && notFound===false){\n            return (<div>Loading...</div>)\n        }\n        else if(notFound === true){\n            return (\n                <section>\n                    {this.searchBar()}\n                    <div><b>{errorMessage}</b></div> \n                </section>\n            )\n        }\n        return ( \n            <section>\n            {this.searchBar()}            \n            {this.state.borrow.map((borrow, index) =>{\n                return(\n                <div  key={index} className=\"card mb-3\">\n                    <div className=\"card-body\">\n                        <h5 className=\"card-title\">#{borrow.id}. {borrow.title}</h5>\n                        <h6 className=\"card-subtitle mb-2 text-muted\">{Moment(borrow.dateIssued).format('YYYY-MM-DD')}</h6>\n                        <p className=\"card-text\">{borrow.username}</p>\n                        {/* <NavLink className=\"btn btn-outline-secondary\" to={{pathname: `/rental/${borrow.id}`, query: {id: borrow.id}}}>Details</NavLink> */}\n                        <button type=\"button\" className=\"btn btn-success\" onClick={() => this.confirmReturn(borrow.id)}>Confirm</button>                       \n                        <button type=\"button\" className=\"btn btn-warning ms-2\" onClick={() => this.extend(borrow.id)}>Extend</button>\n                    </div>\n                </div>\n                )\n            })}\n            \n            </section>\n         );\n    }\n\n    searchBar(){\n        return(\n            <form className=\"d-flex justify-content-center mb-5\">\n                <div className=\"col-auto\">\n                    <p className=\"center-text mx-5\">Find by username</p>\n                </div>\n                <div className=\"col-auto\">\n                    <label className=\"visually-hidden\">Username</label>\n                    <input type=\"text\" className=\"form-control\" placeholder=\"username\" value={this.state.username} onChange={this.usernameHandler}/>\n                </div>\n                <div className=\"col-auto\">\n                    <button type=\"submit\"  onClick={this.filterByUsername} className=\"btn btn-primary mb-3 mx-3\" >Filter</button>\n                </div>\n            </form>\n        )\n    }\n}\n \nexport default Borrow;"]},"metadata":{},"sourceType":"module"}