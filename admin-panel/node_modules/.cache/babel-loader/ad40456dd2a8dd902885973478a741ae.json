{"ast":null,"code":"import _classCallCheck from\"/home/szymon/College/PUZ-Biblioteka/Admin-Panel/admin-panel/admin-panel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/home/szymon/College/PUZ-Biblioteka/Admin-Panel/admin-panel/admin-panel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/home/szymon/College/PUZ-Biblioteka/Admin-Panel/admin-panel/admin-panel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/home/szymon/College/PUZ-Biblioteka/Admin-Panel/admin-panel/admin-panel/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import{withRouter}from'react-router-dom';import Moment from'moment';import{NavLink}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Details=/*#__PURE__*/function(_Component){_inherits(Details,_Component);var _super=_createSuper(Details);function Details(){var _this;_classCallCheck(this,Details);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={id:0,ready:false,notFound:false,errorMessage:\"\",reservation:null,user:null};_this.fetchReservation=function(id){fetch(_this.props.prefix+\"/api/library/admins/reservations/\".concat(id),{method:'GET',headers:{\"Content-Type\":\"application/json\",\"Authorization\":_this.props.getToken()}}).then(function(res){return res.json();}).then(function(res){console.log(res);if(res.status===404){_this.setState({notFound:true,errorMessage:res.message});}else{_this.fetchUser(res.userId);_this.setState({reservation:res,notFound:false});}});};_this.fetchUser=function(id){fetch(_this.props.prefix+\"/api/library/admins/users/\".concat(id),{method:'GET',headers:{\"Content-Type\":\"application/json\",\"Authorization\":_this.props.getToken()}}).then(function(res){return res.json();}).then(function(res){console.log(res);if(res.status===404){_this.setState({notFound:true,errorMessage:res.message});}else{_this.setState({user:res,notFound:false,ready:true});}});};_this.confirmReservation=function(id){fetch(\"\".concat(_this.props.prefix,\"/api/library/admins/confirmBorrow/\").concat(id),{method:'POST',headers:{\"Content-Type\":\"application/json\",\"Authorization\":_this.props.getToken()}}).then(function(res){console.log(res);if(res.status===200){alert(\"Reservation confirmed\");var filteredArray=_this.state.reservations.filter(function(e){return e.id!==id;});_this.setState({reservations:filteredArray});}});};_this.cancelReservation=function(id){fetch(\"\".concat(_this.props.prefix,\"/api/library/admins/reservations/cancel/\").concat(id),{method:'POST',headers:{\"Content-Type\":\"application/json\",\"Authorization\":_this.props.getToken()}}).then(function(res){console.log(res);if(res.status===200){alert(\"Reservation canceled\");var filteredArray=_this.state.reservations.filter(function(e){return e.id!==id;});_this.setState({reservations:filteredArray});}});};return _this;}_createClass(Details,[{key:\"componentDidMount\",value:function componentDidMount(){var url=this.props.location.pathname;var array=url.split('/');var _id=array[array.length-1];this.fetchReservation(_id);this.setState({id:_id});}},{key:\"render\",value:function render(){var _this2=this;var _this$state=this.state,reservation=_this$state.reservation,user=_this$state.user,notFound=_this$state.notFound,errorMessage=_this$state.errorMessage;if((reservation===null||user===null)&&notFound===false){return/*#__PURE__*/_jsx(\"div\",{children:\"Loading...\"});}else if(notFound===true){return/*#__PURE__*/_jsx(\"section\",{children:/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"b\",{children:errorMessage})})});}return/*#__PURE__*/_jsx(\"section\",{className:\"card\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsxs(\"h5\",{className:\"card-title\",children:[\" \",reservation.title]}),/*#__PURE__*/_jsxs(\"h6\",{className:\"card-subtitle mb-2 text-muted\",children:[\"Reservation ID: #\",reservation.id,\" \"]}),/*#__PURE__*/_jsxs(\"p\",{className:\"card-text\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"Username: \"}),reservation.username]}),/*#__PURE__*/_jsxs(\"p\",{className:\"card-text\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"Full name:\"}),\" \",user.firstName,\" \",user.lastName]}),/*#__PURE__*/_jsxs(\"p\",{className:\"card-text\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"Email: \"}),user.email]}),/*#__PURE__*/_jsxs(\"p\",{className:\"card-text\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"Phone: \"}),user.phone]}),/*#__PURE__*/_jsxs(\"p\",{className:\"card-text\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"Issue date: \"}),Moment(reservation.dateReservation).format('YYYY-MM-DD')]}),/*#__PURE__*/_jsx(NavLink,{className:\"btn btn-outline-secondary\",to:\"/reservations\",children:\"Back\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-success ms-2\",onClick:function onClick(){return _this2.confirmReservation(reservation.id);},children:\"Confirm\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-warning ms-2\",onClick:function onClick(){return _this2.cancelReservation(reservation.id);},children:\"Cancel\"})]})});}}]);return Details;}(Component);export default withRouter(Details);","map":{"version":3,"sources":["/home/szymon/College/PUZ-Biblioteka/Admin-Panel/admin-panel/admin-panel/src/components/ReservationDetails/Details.jsx"],"names":["React","Component","withRouter","Moment","NavLink","Details","state","id","ready","notFound","errorMessage","reservation","user","fetchReservation","fetch","props","prefix","method","headers","getToken","then","res","json","console","log","status","setState","message","fetchUser","userId","confirmReservation","alert","filteredArray","reservations","filter","e","cancelReservation","url","location","pathname","array","split","_id","length","title","username","firstName","lastName","email","phone","dateReservation","format"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { withRouter } from 'react-router-dom'\nimport Moment from 'moment';\nimport { NavLink} from 'react-router-dom';\n\nclass Details extends Component {\n    state = { \n        id: 0,\n        ready: false,\n        notFound: false,\n        errorMessage: \"\",\n        reservation: null,\n        user: null\n     }\n\n     componentDidMount(){\n        const url = this.props.location.pathname;\n        const array = url.split('/');\n        const _id = array[array.length-1];\n\n        this.fetchReservation(_id);\n        \n        this.setState({id: _id});\n     }\n\n  fetchReservation = (id) =>{\n    fetch(this.props.prefix + `/api/library/admins/reservations/${id}`, {\n       method: 'GET',\n       headers: {\"Content-Type\": \"application/json\", \"Authorization\": this.props.getToken()}\n      })\n    .then(res => res.json())\n    .then(res => {\n        console.log(res)\n        if(res.status === 404){\n            this.setState({notFound: true, errorMessage: res.message});\n        }\n        else{\n            this.fetchUser(res.userId);\n            this.setState({reservation: res, notFound: false})\n        }       \n    })\n  }\n\n  fetchUser= (id) =>{\n    fetch(this.props.prefix + `/api/library/admins/users/${id}`, {\n       method: 'GET',\n       headers: {\"Content-Type\": \"application/json\", \"Authorization\": this.props.getToken()}\n      })\n    .then(res => res.json())\n    .then(res => {\n        console.log(res)\n        if(res.status === 404){\n            this.setState({notFound: true, errorMessage: res.message});\n        }\n        else{\n            this.setState({user: res, notFound: false, ready: true})\n        }       \n    })\n  }\n\n  confirmReservation = (id) => {\n    fetch(`${this.props.prefix}/api/library/admins/confirmBorrow/${id}`,  {\n       method: 'POST',\n       headers: {\n        \"Content-Type\": \"application/json\",\n        \"Authorization\": this.props.getToken()\n    }\n      })\n      .then(res => {\n          console.log(res);\n          if(res.status === 200){\n              alert(\"Reservation confirmed\");\n              let filteredArray = this.state.reservations.filter(e => e.id !== id);\n              this.setState({reservations: filteredArray});\n          }\n      });\n  }\n\n  cancelReservation = (id) => {\n    fetch(`${this.props.prefix}/api/library/admins/reservations/cancel/${id}`,  {\n       method: 'POST',\n       headers: {\n        \"Content-Type\": \"application/json\",\n        \"Authorization\": this.props.getToken()\n    }\n      })\n      .then(res => {\n          console.log(res);\n          if(res.status === 200){\n              alert(\"Reservation canceled\");\n              let filteredArray = this.state.reservations.filter(e => e.id !== id);\n              this.setState({reservations: filteredArray});\n          }\n      });\n  }\n\n    render() { \n        const {reservation, user, notFound, errorMessage} = this.state;\n        if((reservation === null || user === null) && notFound===false){\n            return (<div>Loading...</div>)\n        }\n        else if(notFound === true){\n            return (\n                <section>\n                    <div><b>{errorMessage}</b></div> \n                </section>\n            )\n        }\n            return ( \n                <section className=\"card\">         \n                    <div className=\"card-body\">\n                            <h5 className=\"card-title\"> {reservation.title}</h5>\n                            <h6 className=\"card-subtitle mb-2 text-muted\">Reservation ID: #{reservation.id} </h6>\n                            <p className=\"card-text\"><b>Username: </b>{reservation.username}</p>\n                            <p className=\"card-text\"><b>Full name:</b> {user.firstName} {user.lastName}</p>\n                            <p className=\"card-text\"><b>Email: </b>{user.email}</p>\n                            <p className=\"card-text\"><b>Phone: </b>{user.phone}</p>\n                            <p className=\"card-text\"><b>Issue date: </b>{Moment(reservation.dateReservation).format('YYYY-MM-DD')}</p>\n                            <NavLink className=\"btn btn-outline-secondary\" to=\"/reservations\">Back</NavLink>\n                            <button type=\"button\" className=\"btn btn-success ms-2\" onClick={() => this.confirmReservation(reservation.id)}>Confirm</button>\n                            <button type=\"button\" className=\"btn btn-warning ms-2\" onClick={() => this.cancelReservation(reservation.id)}>Cancel</button>\n                        </div>\n                </section>\n            );\n    }\n}\n \nexport default withRouter(Details);"]},"metadata":{},"sourceType":"module"}